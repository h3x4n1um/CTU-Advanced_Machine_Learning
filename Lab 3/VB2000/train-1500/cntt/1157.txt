Các máy tính Windows 2000/XP/2003 có một cơ chế bảo mật IP đi kèm mang tên IPSec (IP Security). IPSec là một giao thức được thiết kế để bảo vệ các gói dữ liệu TCP/IP khi chúng truyền tải trong mạng bằng cách sử dụng mã hóa khóa chung. Về bản chất, máy nguồn sẽ gói địa chỉ IP chuẩn bên trong một gói IPSec đã được mã hóa. Sau đó gói dữ liệu này sẽ được duy trì ở trạng thái mã hóa cho tới khi nó đến được máy đích.
Ngoài tính năng kể trên, bên cạnh việc mã hóa, IPSec còn cho phép bạn có thể bảo vệ và cấu hình máy trạm cũng như máy chủ với một cơ chế giống như tường lửa.
Tuy nhiên bạn có thể chặn truy cập Internet của một số người dùng nào đó nhưng vẫn cho phép họ sử dụng trình duyệt web để lướt các site trong mạng nội bộ. Hoàn toàn có thể với IPSec. 
Bạn có thể thực hiện rất đơn giản bằng cách tạo một chính sách để chỉ thị cho máy tính khóa tất cả lưu lượng IP nào đó có sử dụng HTTP và HTTPS, đây là các giao thức sử dụng cổng TCP 80 và 443 với tư cách là các cổng đích của chúng. Bằng việc khóa lưu lượng cụ thể này, bạn có thể chặn một số máy tính nào đó, không cho chúng duyệt Internet.
Tuy nhiên, việc khóa tất cả lưu lượng HTTP và HTTPS sẽ làm cho người dùng của bạn không thể truy cập vào các site nội bộ.
Một giải pháp được đưa ra ở đây là bổ sung thêm một chính sách cho phép lưu lượng HTTP và HTTPS nhưng chỉ dành cho một địa chỉ IP cụ thể, một tên DNS của máy tính cụ thể hoặc toàn bộ một subnet.
Bạn có thể cấu hình chính sách này bằng cách điều chỉnh chính sách IPSec của máy tính đó, hoặc tốt hơn nữa, bạn có thể cấu hình chính sách như một Group Policy Object (GPO) trên một Site, Domain hay Organization Unit (OU) nào đó. Để cấu hình một GPO, bạn phải có Active Directory thích hợp.
Trong IP Traffic Destination, kích danh sách sổ xuống và chọn kiểu đích. Ví dụ, nếu bạn chỉ muốn cho phép lưu lượng web cung cấp từ một máy chủ web nào đó trong mạng nội bộ (chẳng hạn nó mang tên SERVER200), khi đó hãy chọn A Specific DNS Name.
Trong cửa sổ IP Traffic Source, để tùy chọn My IP Address được tích và kích Next.
Nếu muốn cho phép lưu lượng web được cung cấp từ một subnet trong mạng nội bộ, chẳng hạn như 192.168.0.0/24, hãy chọn A Specific IP Subnet, và đánh vào Network ID và Subnet Mask cho subnet yêu cầu. Kích Next.
Trong cửa sổ IP Filter List, chọn một trong các IP Filter đã được cấu hình từ trước, cho ví dụ "HTTP, HTTPS" (được cấu hình trong bước 6 ở phần trên bài viết). Nếu vì một lý do nào đó, bạn không cấu hình đúng IP Filter từ trước thì bạn có thể nhấn Add và thêm nó vào lúc này. Khi xong, kích Next.
Trong cửa sổ Filter Action, chọn một trong các Filter Action đã được cấu hình từ trước, cho ví dụ "Block" (đã được cấu hình trong bước 20 ở phần trên). Tiếp đến, nếu chưa cấu hình đúng Filter Action từ trước thì bạn có thể nhấn Add và thêm nó vào lúc này. Khi xong, kích Next