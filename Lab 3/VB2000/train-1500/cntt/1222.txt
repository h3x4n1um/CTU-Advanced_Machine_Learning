 WiMAX là một công nghệ không dây đang nhận được nhiều sự quan tâm hiện nay. Tuy nhiên, cũng giống như các mạng không dây khác, nhược điểm lớn nhất của WiMAX là tính bảo mật do sự chia sẻ môi trường truyền dẫn và những lỗ hổng tại cơ sở hạ tầng vật lý. Mặc dù vấn đề bảo mật được coi là một trong những vấn đề chính trong quá trình xây dựng giao thức mạng của IEEE nhưng kỹ thuật bảo mật mà IEEE qui định trong IEEE 802.16 (WiMAX) vẫn tồn tại nhiều nhược điểm. Bài viết này sẽ trình bày các khía cạnh
I. GIỚI THIỆU CÔNG NGHỆ WIMAX
WiMAX là tên thương mại của chuẩn IEEE 802.16. Ban đầu chuẩn này được tổ chức IEEE đưa ra nhằm giải quyết các vấn đề kết nối cuối cùng trong một mạng không dây đô thị WMAN hoạt động trong tầm nhìn thẳng (Line of Sight) với khoảng cách từ 30 tới 50 km. Nó được thiết kế để thực hiện đường trục lưu lượng cho các nhà cung cấp dịch vụ Internet không dây, kết nối các điểm nóng WiFi, các hộ gia đình và các doanh nghiệp….đảm bảo QoS cho các dịch vụ thoại, video, hội nghị truyền hình thời gian thực và các dịch vụ khác với tốc độ hỗ trợ lên tới 280 Mbit/s mỗi trạm gốc. Chuẩn IEEE 802.16-2004 hỗ trợ thêm các hoạt động không trong tầm nhìn thẳng tại tần số hoạt động từ 2 tới 11 GHz với các kết nối dạng mesh (lưới) cho cả người dùng cố định và khả chuyển. Chuẩn mới nhất IEEE 802.16e, được giới thiệu vào ngày 28/2/2006 bổ sung thêm khả năng hỗ trợ người dùng di động hoạt động trong băng tần từ 2 tới 6 GHz với phạm vi phủ sóng từ 2 – 5 km. Chuẩn này đang được hy vọng là sẽ mang lại dịch vụ băng rộng thực sự cho những người dùng thường xuyên di động với các thiết bị như laptop, PDA tích hợp công nghệ WiMAX.
1. Khái quát về phân lớp giao thức trong IEEE 802.16 
WiMAX sử dụng công nghệ OFDM (Orthogonal Frequency Division Multiplex). Ưu điểm quan trọng của OFDM là khả năng mang lại hiệu suất băng thông cao hơn và do đó thông lượng dữ liệu sẽ cao hơn ngay cả khi hoạt động trong môi trường kết nối NLOS (None Line of Sight) hay điều kiện đa đường. Trong chuẩn IEEE 802.16-2004, tín hiệu OFDM được chia thành 256 sóng mang, còn chuẩn IEEE 802.16e sử dụng phương thức SOFDMA (Scalable Orthogonal Frequency Division Multiple Access). Chuẩn IEEE 802.16 hỗ trợ một phạm vi rộng các tần số hoạt động và lớp vật lý có thể thực hiện một vài phương thức điều chế và ghép kênh. Phương thức điều chế tại đường xuống và đường lên có thể là BPSK, QPSK, 16-QAM hoặc 64 QAM.
Chuẩn IEEE 802.16 hỗ trợ cả 2 phương thức song công là TDD và FDD. Trong cơ chế TDD, khung đường xuống và đường lên chia sẻ một tần số nhưng tách biệt về mặt thời gian. Trong FDD, truyền tải các khung đường xuống và đường lên diễn ra cùng một thời điểm, nhưng tại các tần số khác nhau.
Độ dài khung có thể là 0.5, 1, 2ms. Trong TDD, phần khung được chỉ định cho đường xuống và phần khung chỉ định cho đường lên có thể có độ dài khác nhau. Đường lên sử dụng phương thức đa truy nhập TDMA, ở đó băng thông được chia thành các khe thời gian. Mỗi một khe thời gian được chỉ định cho một MS (trạm di động) riêng lẻ đang được BS (trạm gốc) phục vụ. Một khung con đường xuống thường chứa 2 phần. Một phần dành cho thông tin điều khiển, chứa mào đầu nhằm đồng bộ và ánh xạ khung và các dữ liệu khác. Một ánh xạ đường xuống (DL_MAP) ấn định vị trí bắt đầu và các thuộc tính truyền dẫn của các cụm dữ liệu. Một ánh xạ đường lên (UL_MAP) chứa thông tin chỉ định băng thông dành cho trạm di động SS.
Lớp MAC bao gồm 3 lớp con: Lớp con hội tụ dịch vụ chuyên biệt (MAC CS), lớp con phần chung (MAC CPS) và lớp con bảo mật. MAC CS có 2 loại lớp con: lớp con hội tụ ATM, và lớp con hội tụ gói dành cho các dịch vụ dữ liệu dạng gói ví dụ như Ethernet, PPP, IP và VLAN. Chức năng cơ bản của lớp CS là nhận dữ liệu từ lớp cao hơn, phân loại dữ liệu dạng ATM hay dạng gói và chuyển các khung này tới lớp CPS.
Phần lõi của lớp MAC IEEE 802.16 là MAC CPS, định nghĩa tất cả các quản lý kết nối, phân phối băng thông, yêu cầu và cấp phát, thủ tục truy nhập hệ thống, lập lịch đường lên, điều khiển kết nối và ARQ. Truyền thông giữa CS và CPS được các điểm truy nhập dịch vụ MAC (MAC SAP) duy trì. Thiết lập, thay đổi, xóa kết nối và truyền tải dữ liệu trên các kênh là bốn chức năng cơ bản trong quá trình truyền thông tại lớp này.
Lớp con bảo mật thực hiện mã hóa dữ liệu trước khi truyền đi và giải mã dữ liệu nhận được từ lớp vật lý. Nó cũng thực hiện nhận thực và trao đổi khóa bảo mật. Chuẩn IEEE 802.16 ban đầu sử dụng phương pháp DES 56 bit cho mã hóa lưu lượng dữ liệu và phương pháp mã hóa 3-DES cho quá trình trao đổi khóa. Trong mạng IEEE 802.16, trạm gốc chứa 48 bit ID nhận dạng trạm gốc (chú ý rằng đây không phải là một địa chỉ MAC), còn SS có 48 bit địa chỉ MAC 802.3. Có 2 giao thức chính hoạt động trong lớp con bảo mật: giao thức mã hóa dữ liệu thông qua mạng băng rộng không dây, và giao thức quản lý khóa bảo và bảo mật (PKM- Privacy and Key Management Protocol) đảm bảo an toàn cho quá trình phân phối khóa từ BS tới SS. Nó cũng cho phép BS đặt điều kiện truy nhập cho các dịch vụ mạng. Giao thức PKM sử dụng thuật toán khóa công khai RSA, chứng thực số X.509 và thuật toán mã hóa mạnh để thực hiện trao đổi khóa giữa SS và BS. Giao thức bảo mật này dựa trên giao thức PKM của DOCSIS BPI+ đã được cải tiến để cung cấp một lược đồ mã hóa mạnh hơn như chuẩn mã hóa cải tiến AES.
MAC trong IEEE 802.16 là phân lớp hướng kết nối, được thiết kế cho các ứng dụng truy nhập không dây băng rộng theo cấu hình điểm đa điểm (PMP), hay dạng mesh. Có hai loại kết nối MAC được xác định bởi 16 bit nhận dạng kết nối CID là: Các kết nối quản lý và Các kết nối vận chuyển dữ liệu. Các kết nối quản lý lại gồm 3 loại: cơ sở, sơ cấp và thứ cấp trong đó cơ sở sử dụng cho truyền tải, điều khiển liên kết vô tuyến…,còn sơ cấp liên quan đến thiết lập nhận thực và kết nối, và kết nối quản lý thứ cấp là các bản tin quản lý dựa trên chuẩn truyền tải như DHCP, TFTP, SNMP. Kết nối quản lý sơ cấp và kết nối cơ sở được tạo ra khi một MS/SS ra nhập vào một BS phục vụ của mạng. Kết nối vận chuyển dữ liệu có thể được thiết lập dựa trên nhu cầu. Chúng được sử dụng cho các luồng lưu lượng người sử dụng, các dịch vụ đơn hướng (Unicast) và đa hướng (Multicast). Các kênh bổ sung cũng được MAC dự trữ để gửi ra ngoài các thông tin lập lịch đường xuống và đường lên.
Các thành phần cơ bản của mạng là trạm gốc BS và trạm thuê bao SS (Subscriber Station), trạm gốc BS giống như các điểm truy nhập (AP) trong mạng WiFi. BS được nối với phần hữu tuyến, nó phát quảng bá các thông tin tới SS. Khác với phương pháp CSMA/CA trong 802.11, 802.16 sử dụng các ánh xạ đường xuống và đường lên để khắc phục xung đột trong môi trường truy nhập. SS sử dụng phương thức truy nhập TDMA để chia sẻ đường lên trong khi BS sử dụng phương thức TDM. Tất cả các chức năng này được thực hiện thông qua bản tin DL_MAP và UL_MAP.
Khuôn dạng bản tin MAC
Đơn vị giao thức dữ liệu MAC (MPDU) chứa các bản tin trao đổi giữa BS MAC và SS MAC. Nó có 3 phần: Một Header MAC có độ dài cố định, header này chứa thông tin điều khiển khung, một tải có độ dài thay đổi (Frame Body) và một giá kiểm tra tuần tự khung (FCS – Frame Check Sequence) chứa 32 bit CRC.
Các loại MAC Header là: đơn vụ dữ liệu dịch vụ MSDU (MAC Service Data Unit) ở đây tải là các đoạn MAC SDU ví dụ như dữ liệu đến từ các lớp cao hơn (CS PDU), thứ 2 là Generic MAC Header (GMH), ở đây tải là các bản tin quản lý MAC hoặc các gói được đóng gói trong các MAC CS PDU, cả 2 MSPU và GMH đều được truyền trên các kết nối quản lý, thứ 3 là một BRH (Bandwidth Request Header) không có tải.
Ngoại trừ các Bandwidth Request PDU, các MAC PDU có thể chứa bản tin quản lý MAC hoặc dữ liệu lớp con hội tụ – MSDU. Với GMH và MSDU, bit HT (Header Type) luôn luôn được thiết lập là 0 (Zero) trong khi BRH luôn luôn được đặt là 1. MAC Header có chứa một cờ, chỉ ra loại tải của PDU có được mã hóa hay không.
Trong chuẩn IEEE 802.16-2001, MAC Header và tất cả các bản tin quản lý MAC không được mã hóa. Quy định này tạo sự đơn giản cho quá trình đăng ký, tranh chấp và các hoạt động khác tại lớp con MAC. Trong chuẩn mới nhất của tổ chức IEEE 802.16e, các tải của MAC PDU được mã hóa theo chuẩn DES theo cơ chế CBC, hoặc AES trong cơ chế CCM. Phiên bản bổ xung IEEE 802.16e cũng đưa ra một kỹ thuật bảo toàn tính nguyên vẹn lưu lượng dữ liệu.
Liên kết bảo mật SA
SA (Security Association) chứa các thông tin về bảo mật của một kết nối: tức là các khóa và các thuật toán mã hóa được lựa chọn. Các kết nối quản lý cơ sở và sơ cấp không có SA. Tuy vậy, tính nguyên vẹn của bản tin quản lý vẫn được đảm bảo. Kết nối có quản lý thứ cấp có thể có SA. Các kết nối vận chuyển luôn chứa SA. Có 2 loại SA là DSA (Data SA) và ASA (Authentication SA), tuy nhiên IEEE 802.16 chỉ định nghĩa rõ ràng DSA. SA – liên kết bảo mật được nhận dạng bằng SAID.
DSA
DSA (Data Security Association) có 16bit nhận dạng SA, thông tin phương thức mã hóa (chuẩn mã hóa cải tiến DES hoạt động theo cơ chế CBC) nhằm bảo vệ dữ liệu khi truyền chúng trên kênh truyền và 2 TEK (Traffic Encrytion Key) để mã hóa dữ liệu: một khóa TEK đang hoạt động và một khóa dự phòng. Mỗi TEK sử dụng một véc tơ khởi tạo IV 64bit. Thời gian sống của một TEK nằm trong khoảng từ 30 phút tới 7 ngày. Có 3 loại DSA là: Primary SA được sử dụng trong quá trình khởi tạo liên kết, Static SA đã được cấu hình trên BS và Dynamic SA được sử dụng cho các kết nối vận chuyển khi cần. Primary SA được chia sẻ giữa MS và BS đang phục vụ nó. Static SA và Dynamic SA có thể được một vài MS chia sẻ trong hoạt động Multicast. Khi thực hiện kết nối, đầu tiên SA khởi tạo một DSA bằng cách sử dụng chức năng yêu cầu kết nối. Một SS thông thường có 2 hoặc 3 SA, một cho kết nối quản lý thứ cấp, một cho kết nối cho cả đường lên và đường xuống, hoặc sử dụng các SA tách biệt cho kênh đường lên và đường xuống. BS đảm bảo rằng mỗi SS chỉ có thể truy nhập bằng SA mà nó cấp riêng cho SS.
SA chứng thực
SA chứng thực (ASA-Authentication SA) bao gồm một khóa cấp phép dài 60 bit (AK) và 4 bit nhận dạng AK. Thời gian sử dụng của AK thay đổi từ 1 tới 70 ngày. Khóa mã hóa khóa KEK (Key Encryption key) sử dụng thuật toán 3 DES 112bit cho các TEK phân phối (Temporal encryption key) và một danh sách các DSA cấp phép. Khóa HMAC đường xuống DL và đường lên UL (Hash function-based message authentication code) được sử dụng để nhận thực dữ liệu trong các bản tin phân phối khóa từ BS tới SS và SS tới BS. Trạng thái của một SA chứng thực được chia sẻ giữa một BS và một SS thực tế. Các BS sử dụng SA chứng thực để cấu hình các DSA trên SS. 
Quá trình nhận thực như sau: SS sử dụng chứng chỉ X.509 (trong đó có chứa khóa công khai của MS) để trao đổi các khả năng bảo mật với BS. Sau đó BS tạo ra AK và gửi nó tới MS, AK này được mã hóa bằng khóa công khai của MS sử dụng lược đồ mã hóa công khai RSA. Quá trình nhận thực hoàn thành khi cả SS và BS đều sở hữu AK. 
Trao đổi khóa dữ liệu (Data Key Exchange)
Sau khi nhận thực thành công, MS và BS sẽ sử dụng AK để tạo ra các khóa mã hóa khóa KEK, hoặc để tạo ra các khóa mã nhận thực bản tin băm HMAC (Hashed Message Authentication Code). Khóa HMAC được sử dụng để phục vụ cho quá trình tạo và xác thực các bản tin quản lý MAC. Còn KEK được sử dụng để bảo vệ các khóa mật mã lưu lượng TEK (Traffic Encryption Key). Khóa TEK là khóa dùng để mã hóa dữ liệu, TEK được BS tạo ra.
TEK được thuật toán 3-DES (sử dụng 112 bit khóa KEK), RSA (sử dụng khóa công khai của SS), và AES (sử dụng 128 bit khóa KEK) mã hóa. Bản tin trao đổi khóa được chứng thực bằng hàm HMAC-SHA1, nhằm đảm bảo tính nguyên vẹn của bản tin và chứng thực AK.